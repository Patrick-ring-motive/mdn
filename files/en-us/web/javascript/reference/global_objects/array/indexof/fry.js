/* TODO bit shift index trick */